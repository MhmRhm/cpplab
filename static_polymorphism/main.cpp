#include <array>
#include <cstdint>
#include <format>
#include <iomanip>
#include <iostream>
#include <iterator>
#include <span>

#include "crtp.h"

int main() {
  using namespace std;
  cout << hex;
  {
    array<uint8_t, sizeof(TS)> data{
        0xe2, 0x48, 0xa7, 0xba, 0xc0, 0x78, 0x71, 0x07, 0xbe, 0x9b, 0x20, 0x54,
        0x73, 0xb3, 0x0c, 0xa0, 0xc7, 0x6c, 0x84, 0x14, 0x93, 0xda, 0x4d, 0x33,
        0xe9, 0x09, 0x31, 0xc1, 0xf5, 0x44, 0x37, 0x63, 0xe0, 0x7b, 0x21, 0x1a,
        0xa4, 0xfb, 0x42, 0xe3, 0x29, 0xc8, 0x12, 0xfc, 0xfb, 0xf1, 0x02, 0x4d,
        0x92, 0x0e, 0x9d, 0xc7, 0x39, 0xd3, 0xef, 0x3d};
    const TS *ts{reinterpret_cast<const TS *>(&data)};
    printPayload(*ts);
  }
  {
    array<uint8_t, sizeof(TLP)> data{
        0x37, 0x81, 0xb8, 0x65, 0xbd, 0x4c, 0xe0, 0x20, 0x21, 0xb4, 0xc7,
        0x31, 0xf5, 0xf4, 0x45, 0xa7, 0x95, 0xd8, 0x1d, 0x57, 0xb2, 0x5b,
        0xd1, 0x5a, 0xe7, 0x19, 0x0b, 0x24, 0xce, 0x05, 0x68, 0x59};
    const TLP *tlp{reinterpret_cast<const TLP *>(&data)};
    printPayload(*tlp);
  }
  {
    TS *ts{new TS{}};
    TLP *tlp{new TLP{}};
    trash(ts);
    trash(tlp);
  }
}
